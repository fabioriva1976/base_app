---
import BaseLayout from './BaseLayout.astro';
import SidebarProfile from '../components/SidebarProfile.astro';

interface Props {
  title?: string;
}

const { title } = Astro.props;
const user = Astro.locals.user;
---

<BaseLayout title={title}>
  <SidebarProfile slot="sidebar" />
  <slot />
</BaseLayout>

<script>
  // Inizializzazione Firebase client-side per features interattive
  import { auth } from '../lib/firebase-client';

  // Aggiorna avatar se Firebase fornisce un photoURL personalizzato
  import { onAuthStateChanged } from 'firebase/auth';

  onAuthStateChanged(auth, (user) => {
    if (user && user.photoURL) {
      const avatarIcon = document.getElementById('avatar-icon') as HTMLImageElement;
      if (avatarIcon) {
        avatarIcon.src = user.photoURL;
      }
    }
  });
</script>
