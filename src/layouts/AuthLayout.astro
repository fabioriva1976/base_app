---
import BaseLayout from './BaseLayout.astro';
import Sidebar from '../components/Sidebar.astro';

interface Props {
  title?: string;
}

const { title } = Astro.props;
const user = Astro.locals.user;
---

<BaseLayout title={title}>
  <Sidebar slot="sidebar" />
  <slot />
</BaseLayout>

<script>
  // Features UI aggiuntive per AuthLayout
  import { auth } from '../lib/firebase-client';
  import { onAuthStateChanged } from 'firebase/auth';

  // Aggiorna avatar se Firebase fornisce un photoURL personalizzato
  onAuthStateChanged(auth, (user) => {
    if (user && user.photoURL) {
      const avatarIcon = document.getElementById('avatar-icon') as HTMLImageElement;
      if (avatarIcon) {
        avatarIcon.src = user.photoURL;
      }
    }
  });

  // NOTA: Gestione profilo e logout sono gestiti da BaseLayout e Sidebar
  // per evitare duplicazioni di codice
</script>
